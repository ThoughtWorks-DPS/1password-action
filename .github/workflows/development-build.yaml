name: static analysis

on:
  push:
    branches:
      - "*"
    tags:
      - "!*"

jobs:

  static-code-analysis:
    name: static code analysis
    uses: ThoughtWorks-DPS/gha-tools-action/.github/workflows/static-code-analysis.yaml@main

  # gha-static-code-analysis:
  #   name: gha static code analysis
  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: checkout code
  #       uses: actions/checkout@v4.1.4

  #     # - name: gha-tools/lint
  #     #   run: yamllint .

  #     - name: check values
  #       run: echo "$GITHUB_WORKFLOW_REF"



      # - orb-tools/review:
      #     max_command_length: 100
      #     exclude: RC010
      #     filters: *on-push-main

      # - shellcheck/check:
      #     filters: *on-push-main

      # - orb-tools/pack:
      #     filters: *on-push-main

      # - orb-tools/publish:
      #     name: publish development package
      #     context: *context
      #     orb_name: *orb-name
      #     vcs_type: << pipeline.project.type >>
      #     filters: *on-push-main
      #     requires:
      #       - orb-tools/lint
      #       - orb-tools/review
      #       - shellcheck/check
      #       - orb-tools/pack

      # - orb-tools/continue:
      #     name: Launch integration test pipeline
      #     context: *context
      #     orb_name: *orb-name
      #     config_path: .circleci/integration-test.yml
      #     pipeline_number: << pipeline.number >>
      #     vcs_type: << pipeline.project.type >>
      #     filters: *on-push-main
      #     requires:
      #       - publish development package



  # notify
  # on-success:
  #   name: deploy
  #   uses: aws-engineering-poc/shared-actions/.github/workflows/notify.yaml@main
  #   needs: 
  #     - static-code-analysis
  #     - plan-pocdev-changes
  #     - apply-pocdev-changes
  #     - pocdev-smoke-tests
  #   with:
  #     message: "poc-platform-eks-core-services pocdev deployment - URL : ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
  #     sns-topic-name: "slack_notification_topic"
  #   secrets:
  #     AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  #     AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}       
  #   if: success()

  # on-failure:
  #   name: fail
  #   uses: aws-engineering-poc/shared-actions/.github/workflows/notify.yaml@main
  #   needs: 
  #     - static-code-analysis
  #     - plan-pocdev-changes
  #     - apply-pocdev-changes
  #     - pocdev-smoke-tests
  #   with:
  #     message: "Failure - poc-platform-eks-core-services pocdev deployment - URL : ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
  #     sns-topic-name: "slack_notification_topic"
  #   secrets:
  #     AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  #     AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}       
  #   if: failure()

  #     - name: install 1Password CLI
  #       uses: 1password/install-cli-action@v1
